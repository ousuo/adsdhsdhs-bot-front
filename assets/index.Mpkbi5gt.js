var e=Object.defineProperty,t=(t,i,a)=>((t,i,a)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a)(t,"symbol"!=typeof i?i+"":i,a);!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const i={token:null,isAuthenticated:!1,userLimits:null,formData:{category:"",subcategory:null,condition:null,title:"",description:"",price:"",negotiable:!1,contact:"",location:null,dynamicFields:{},scheduledTime:null},photos:[],uploadingCount:0,currentView:"form",isLoading:!1,error:null,currentSubcategories:null,currentConditions:null,currentDynamicFields:null};const a=new class{constructor(){t(this,"state",{...i}),t(this,"listeners",new Set)}getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notify(){this.listeners.forEach(e=>e(this.state))}setState(e){this.state={...this.state,...e},this.notify()}setToken(e){this.setState({token:e,isAuthenticated:!!e})}setUserLimits(e){this.setState({userLimits:e})}updateFormData(e){this.setState({formData:{...this.state.formData,...e}})}setDynamicField(e,t){this.setState({formData:{...this.state.formData,dynamicFields:{...this.state.formData.dynamicFields,[e]:t}}})}clearDynamicFields(){this.setState({formData:{...this.state.formData,dynamicFields:{}}})}setLocation(e){this.setState({formData:{...this.state.formData,location:e}})}addPhoto(e){this.setState({photos:[...this.state.photos,e]})}updatePhoto(e,t){this.setState({photos:this.state.photos.map(i=>i.id===e?{...i,...t}:i)})}removePhoto(e){this.setState({photos:this.state.photos.filter(t=>t.id!==e)})}setUploadingCount(e){this.setState({uploadingCount:e})}incrementUploading(){this.setState({uploadingCount:this.state.uploadingCount+1})}decrementUploading(){this.setState({uploadingCount:Math.max(0,this.state.uploadingCount-1)})}setCurrentView(e){this.setState({currentView:e})}setLoading(e){this.setState({isLoading:e})}setError(e){this.setState({error:e})}setCurrentSubcategories(e){this.setState({currentSubcategories:e})}setCurrentConditions(e){this.setState({currentConditions:e})}setCurrentDynamicFields(e){this.setState({currentDynamicFields:e})}reset(){this.state={...i},this.notify()}resetForm(){this.setState({formData:{...i.formData},photos:[],uploadingCount:0,currentSubcategories:null,currentConditions:null,currentDynamicFields:null})}};const s=new class{constructor(){t(this,"_tg",null),t(this,"_initialized",!1),t(this,"_mainButtonCallback",null)}get tg(){return this._tg}get isAvailable(){return null!==this._tg}get user(){return this._tg?.initDataUnsafe?.user}get initData(){return this._tg?.initData||""}get themeParams(){return this._tg?.themeParams||{}}get colorScheme(){return this._tg?.colorScheme||"light"}get mainButton(){return this._tg?.MainButton}init(){if(this._initialized)return this.isAvailable;if(this._tg=window.Telegram?.WebApp||null,this._initialized=!0,!this._tg)return!1;try{return this._tg.ready(),this._tg.expand(),this._tg.enableClosingConfirmation(),!0}catch(e){return!1}}haptic(e="light"){if(this._tg?.HapticFeedback)try{["success","error","warning"].includes(e)?this._tg.HapticFeedback.notificationOccurred(e):this._tg.HapticFeedback.impactOccurred(e)}catch(t){}}showPopup(e,t,i){this._tg?.showPopup?this._tg.showPopup({title:e,message:t,buttons:i||[{type:"ok"}]}):alert(`${e}\n\n${t}`)}showAlert(e,t){this._tg?.showAlert?this._tg.showAlert(e,t):(alert(e),t?.())}showConfirm(e,t){this._tg?.showConfirm?this._tg.showConfirm(e,t):t(confirm(e))}sendData(e){return!!this._tg?.sendData&&(this._tg.sendData(e),!0)}setupMainButton(e,t){const i=this.mainButton;if(i)try{this._mainButtonCallback&&i.offClick(this._mainButtonCallback),this._mainButtonCallback=t,i.setText(e),i.onClick(t),i.show()}catch(a){}}updateMainButton(e){const t=this.mainButton;if(t)try{void 0!==e.text&&t.setText(e.text),!0===e.enabled&&t.enable(),!1===e.enabled&&t.disable(),!0===e.visible&&t.show(),!1===e.visible&&t.hide(),!0===e.progress&&t.showProgress(!0),!1===e.progress&&t.hideProgress(),e.color&&(t.color=e.color)}catch(i){}}enableClosingConfirmation(){try{this._tg?.enableClosingConfirmation()}catch(e){}}disableClosingConfirmation(){try{this._tg?.disableClosingConfirmation()}catch(e){}}},n={apiUrl:"https://your-api-domain.com/api",yandexMapsKey:"0ea443fd-4bed-4404-a064-f2202a8de835",maxPhotos:5,maxFileSize:5242880,maxDataSize:4e4,minTitleLength:3,maxTitleLength:100,minDescLength:10,maxDescLength:1e3,defaultMapCenter:[43.024615,44.681767],uploadRetryCount:2,uploadRetryDelay:1e3,apiTimeout:3e4,debug:!1};const l=new class{constructor(){t(this,"baseUrl"),t(this,"timeout"),this.baseUrl=n.apiUrl,this.timeout=n.apiTimeout}getHeaders(){const e={"Content-Type":"application/json"},t=a.getState().token;return t&&(e.Authorization=`Bearer ${t}`),e}async request(e,t,i,a){const s=new AbortController,n=setTimeout(()=>s.abort(),this.timeout);try{const n=`${this.baseUrl}${t}`,l={method:e,headers:{...this.getHeaders(),...a},signal:s.signal};i&&"GET"!==e&&(l.body=JSON.stringify(i));const o=await fetch(n,l),r=await o.json();return o.ok?{success:!0,data:r}:{success:!1,error:r.error||`HTTP ${o.status}`,code:r.code}}catch(l){return"AbortError"===l.name?{success:!1,error:"Request timeout"}:{success:!1,error:l.message||"Network error"}}finally{clearTimeout(n)}}get(e){return this.request("GET",e)}post(e,t){return this.request("POST",e,t)}put(e,t){return this.request("PUT",e,t)}delete(e){return this.request("DELETE",e)}},o={async authenticate(){const e=s.initData;if(!e)return!1;const t=await l.post("/auth/token",{init_data:e});return!(!t.success||!t.data)&&(a.setToken(t.data.access_token),!0)},async getUserLimits(){const e=await l.get("/user/limits");return!(!e.success||!e.data)&&(a.setUserLimits({activeSlots:e.data.active_slots,maxSlots:e.data.max_slots,availableSlots:e.data.available_slots,cooldownSeconds:e.data.cooldown_remaining_seconds||null,canPublish:e.data.can_publish,isAdmin:e.data.is_admin}),!0)},logout(){a.setToken(null),a.setUserLimits(null)}},r={"–†–∞–±–æ—Ç–∞":[{value:"–ò—â—É_—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞",label:"üëî –ò—â—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},{value:"–ò—â—É_—Ä–∞–±–æ—Ç—É",label:"üíº –ò—â—É —Ä–∞–±–æ—Ç—É"},{value:"–ü–æ–¥—Ä–∞–±–æ—Ç–∫–∞",label:"‚è∞ –ü–æ–¥—Ä–∞–±–æ—Ç–∫–∞"},{value:"–°—Ç–∞–∂–∏—Ä–æ–≤–∫–∞",label:"üéì –°—Ç–∞–∂–∏—Ä–æ–≤–∫–∞"}],"–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç":[{value:"–õ–µ–≥–∫–æ–≤—ã–µ",label:"üöó –õ–µ–≥–∫–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏"},{value:"–ì—Ä—É–∑–æ–≤–∏–∫–∏",label:"üöö –ì—Ä—É–∑–æ–≤–∏–∫–∏"},{value:"–ú–æ—Ç–æ—Ü–∏–∫–ª—ã",label:"üèçÔ∏è –ú–æ—Ç–æ—Ü–∏–∫–ª—ã"},{value:"–°–ø–µ—Ü—Ç–µ—Ö–Ω–∏–∫–∞",label:"üöú –°–ø–µ—Ü—Ç–µ—Ö–Ω–∏–∫–∞"},{value:"–ó–∞–ø—á–∞—Å—Ç–∏",label:"üîß –ó–∞–ø—á–∞—Å—Ç–∏"}],"–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞":[{value:"–¢–µ–ª–µ—Ñ–æ–Ω—ã",label:"üì± –¢–µ–ª–µ—Ñ–æ–Ω—ã"},{value:"–ö–æ–º–ø—å—é—Ç–µ—Ä—ã",label:"üíª –ö–æ–º–ø—å—é—Ç–µ—Ä—ã"},{value:"–ù–æ—É—Ç–±—É–∫–∏",label:"üíª –ù–æ—É—Ç–±—É–∫–∏"},{value:"–ü–ª–∞–Ω—à–µ—Ç—ã",label:"üì≤ –ü–ª–∞–Ω—à–µ—Ç—ã"},{value:"–¢–í_–ê—É–¥–∏–æ",label:"üì∫ –¢–í –∏ –ê—É–¥–∏–æ"},{value:"–§–æ—Ç–æ_–í–∏–¥–µ–æ",label:"üì∑ –§–æ—Ç–æ –∏ –í–∏–¥–µ–æ"},{value:"–ò–≥—Ä–æ–≤—ã–µ",label:"üéÆ –ò–≥—Ä–æ–≤—ã–µ –ø—Ä–∏—Å—Ç–∞–≤–∫–∏"}],"–û–¥–µ–∂–¥–∞":[{value:"–ñ–µ–Ω—Å–∫–∞—è",label:"üëó –ñ–µ–Ω—Å–∫–∞—è –æ–¥–µ–∂–¥–∞"},{value:"–ú—É–∂—Å–∫–∞—è",label:"üëî –ú—É–∂—Å–∫–∞—è –æ–¥–µ–∂–¥–∞"},{value:"–û–±—É–≤—å",label:"üëü –û–±—É–≤—å"},{value:"–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã",label:"üëú –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã"},{value:"–î–µ—Ç—Å–∫–∞—è",label:"üë∂ –î–µ—Ç—Å–∫–∞—è –æ–¥–µ–∂–¥–∞"}],"–£—Å–ª—É–≥–∏":[{value:"–†–µ–º–æ–Ω—Ç",label:"üîß –†–µ–º–æ–Ω—Ç"},{value:"–ö—Ä–∞—Å–æ—Ç–∞",label:"üíá –ö—Ä–∞—Å–æ—Ç–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ"},{value:"–û–±—É—á–µ–Ω–∏–µ",label:"üìñ –û–±—É—á–µ–Ω–∏–µ"},{value:"–£–±–æ—Ä–∫–∞",label:"üßπ –£–±–æ—Ä–∫–∞"},{value:"–ü–µ—Ä–µ–≤–æ–∑–∫–∏",label:"üöö –ü–µ—Ä–µ–≤–æ–∑–∫–∏"},{value:"–î—Ä—É–≥–∏–µ",label:"‚öôÔ∏è –î—Ä—É–≥–∏–µ —É—Å–ª—É–≥–∏"}]},c={"–õ–µ–≥–∫–æ–≤—ã–µ":[{value:"–ù–æ–≤—ã–π",label:"‚ú® –ù–æ–≤—ã–π"},{value:"–°_–ø—Ä–æ–±–µ–≥–æ–º",label:"üîÑ –° –ø—Ä–æ–±–µ–≥–æ–º"}],"–ì—Ä—É–∑–æ–≤–∏–∫–∏":[{value:"–ù–æ–≤—ã–π",label:"‚ú® –ù–æ–≤—ã–π"},{value:"–°_–ø—Ä–æ–±–µ–≥–æ–º",label:"üîÑ –° –ø—Ä–æ–±–µ–≥–æ–º"}],"–ú–æ—Ç–æ—Ü–∏–∫–ª—ã":[{value:"–ù–æ–≤—ã–π",label:"‚ú® –ù–æ–≤—ã–π"},{value:"–°_–ø—Ä–æ–±–µ–≥–æ–º",label:"üîÑ –° –ø—Ä–æ–±–µ–≥–æ–º"}],"–°–ø–µ—Ü—Ç–µ—Ö–Ω–∏–∫–∞":[{value:"–ù–æ–≤–∞—è",label:"‚ú® –ù–æ–≤–∞—è"},{value:"–°_–ø—Ä–æ–±–µ–≥–æ–º",label:"üîÑ –° –ø—Ä–æ–±–µ–≥–æ–º"}],"–¢–µ–ª–µ—Ñ–æ–Ω—ã":[{value:"–ù–æ–≤—ã–π",label:"‚ú® –ù–æ–≤—ã–π"},{value:"–ö–∞–∫_–Ω–æ–≤—ã–π",label:"‚≠ê –ö–∞–∫ –Ω–æ–≤—ã–π"},{value:"–•–æ—Ä–æ—à–µ–µ",label:"üëç –•–æ—Ä–æ—à–µ–µ"},{value:"–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ",label:"üì¶ –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ"}],"–ù–æ—É—Ç–±—É–∫–∏":[{value:"–ù–æ–≤—ã–π",label:"‚ú® –ù–æ–≤—ã–π"},{value:"–ë/–£_–æ—Ç–ª–∏—á–Ω–æ–µ",label:"‚≠ê –ë/–£ –æ—Ç–ª–∏—á–Ω–æ–µ"},{value:"–ë/–£_—Ö–æ—Ä–æ—à–µ–µ",label:"üëç –ë/–£ —Ö–æ—Ä–æ—à–µ–µ"}],"–ö–æ–º–ø—å—é—Ç–µ—Ä—ã":[{value:"–ù–æ–≤—ã–π",label:"‚ú® –ù–æ–≤—ã–π"},{value:"–ë/–£_–æ—Ç–ª–∏—á–Ω–æ–µ",label:"‚≠ê –ë/–£ –æ—Ç–ª–∏—á–Ω–æ–µ"},{value:"–ë/–£_—Ö–æ—Ä–æ—à–µ–µ",label:"üëç –ë/–£ —Ö–æ—Ä–æ—à–µ–µ"}]},d=new Set(["–†–∞–±–æ—Ç–∞"]),u=new Set(["–ò—â—É_—Ä–∞–±–æ—Ç—É","–ò—â—É_—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞","–ü–æ–¥—Ä–∞–±–æ—Ç–∫–∞","–°—Ç–∞–∂–∏—Ä–æ–≤–∫–∞"]),h={"–ò—â—É_—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞":{title:"üíº –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∞–∫–∞–Ω—Å–∏–∏",fields:[{id:"company_sphere",label:"–°—Ñ–µ—Ä–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–∞–Ω–∏–∏",type:"select",required:!0,options:[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ñ–µ—Ä—É",disabled:!0},{value:"IT",label:"üíª IT –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞"},{value:"–¢–æ—Ä–≥–æ–≤–ª—è",label:"üõí –¢–æ—Ä–≥–æ–≤–ª—è –∏ –ø—Ä–æ–¥–∞–∂–∏"},{value:"–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ",label:"üè≠ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ"},{value:"–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ",label:"üèóÔ∏è –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ"},{value:"–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",label:"üéì –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"},{value:"–ú–µ–¥–∏—Ü–∏–Ω–∞",label:"‚öïÔ∏è –ú–µ–¥–∏—Ü–∏–Ω–∞"},{value:"–§–∏–Ω–∞–Ω—Å—ã",label:"üí∞ –§–∏–Ω–∞–Ω—Å—ã –∏ –±–∞–Ω–∫–∏"},{value:"–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥",label:"üìä –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ —Ä–µ–∫–ª–∞–º–∞"},{value:"–õ–æ–≥–∏—Å—Ç–∏–∫–∞",label:"üöö –õ–æ–≥–∏—Å—Ç–∏–∫–∞ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},{value:"HoReCa",label:"üçΩÔ∏è HoReCa"},{value:"–î—Ä—É–≥–æ–µ",label:"üì¶ –î—Ä—É–≥–æ–µ"}]},{id:"work_schedule",label:"–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã",type:"select",required:!0,options:[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä–∞—Ñ–∏–∫",disabled:!0},{value:"–ü–æ–ª–Ω—ã–π_–¥–µ–Ω—å",label:"üïê –ü–æ–ª–Ω—ã–π –¥–µ–Ω—å (5/2)"},{value:"–°–º–µ–Ω–Ω—ã–π",label:"üîÑ –°–º–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫"},{value:"–ì–∏–±–∫–∏–π",label:"‚è∞ –ì–∏–±–∫–∏–π –≥—Ä–∞—Ñ–∏–∫"},{value:"–£–¥–∞–ª–µ–Ω–Ω–∞—è",label:"üè† –£–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞"},{value:"–í–∞—Ö—Ç–∞",label:"üèóÔ∏è –í–∞—Ö—Ç–æ–≤—ã–π –º–µ—Ç–æ–¥"},{value:"–ß–∞—Å—Ç–∏—á–Ω–∞—è",label:"‚è±Ô∏è –ß–∞—Å—Ç–∏—á–Ω–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å"}]},{id:"employment_type",label:"–£—Å–ª–æ–≤–∏—è –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞",type:"select",required:!0,options:[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è",disabled:!0},{value:"–¢—Ä—É–¥–æ–≤–æ–π_–¥–æ–≥–æ–≤–æ—Ä",label:"üìã –¢—Ä—É–¥–æ–≤–æ–π –¥–æ–≥–æ–≤–æ—Ä"},{value:"–ì–ü–•_–ò–ü",label:"üíº –î–æ–≥–æ–≤–æ—Ä –ì–ü–• —Å –ò–ü"},{value:"–ì–ü–•_–°–∞–º–æ–∑–∞–Ω—è—Ç—ã–π",label:"üìù –î–æ–≥–æ–≤–æ—Ä –ì–ü–• —Å —Å–∞–º–æ–∑–∞–Ω—è—Ç—ã–º"},{value:"–ë–µ–∑_–æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è",label:"ü§ù –ë–µ–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è"},{value:"–ü–æ_–¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏",label:"üí¨ –ü–æ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏"}]},{id:"salary_from",label:"–ó–∞—Ä–ø–ª–∞—Ç–∞ –æ—Ç",type:"number",required:!1,placeholder:"50000",min:0},{id:"salary_to",label:"–ó–∞—Ä–ø–ª–∞—Ç–∞ –¥–æ",type:"number",required:!1,placeholder:"80000",min:0}]},"–ò—â—É_—Ä–∞–±–æ—Ç—É":{title:"üíº –û —Å–æ–∏—Å–∫–∞—Ç–µ–ª–µ",fields:[{id:"desired_position",label:"–ñ–µ–ª–∞–µ–º–∞—è –¥–æ–ª–∂–Ω–æ—Å—Ç—å",type:"text",required:!0,placeholder:"–ù–∞–ø—Ä–∏–º–µ—Ä: Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫"},{id:"experience_years",label:"–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã",type:"select",required:!0,options:[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—ã—Ç",disabled:!0},{value:"–ë–µ–∑_–æ–ø—ã—Ç–∞",label:"üå± –ë–µ–∑ –æ–ø—ã—Ç–∞"},{value:"–î–æ_1_–≥–æ–¥–∞",label:"üìÖ –î–æ 1 –≥–æ–¥–∞"},{value:"1-3_–≥–æ–¥–∞",label:"üìä 1-3 –≥–æ–¥–∞"},{value:"3-5_–ª–µ—Ç",label:"‚≠ê 3-5 –ª–µ—Ç"},{value:"–ë–æ–ª–µ–µ_5_–ª–µ—Ç",label:"üèÜ –ë–æ–ª–µ–µ 5 –ª–µ—Ç"}]},{id:"desired_schedule",label:"–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—ã–π –≥—Ä–∞—Ñ–∏–∫",type:"select",required:!1,options:[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä–∞—Ñ–∏–∫",disabled:!0},{value:"–ü–æ–ª–Ω—ã–π_–¥–µ–Ω—å",label:"üïê –ü–æ–ª–Ω—ã–π –¥–µ–Ω—å"},{value:"–ì–∏–±–∫–∏–π",label:"‚è∞ –ì–∏–±–∫–∏–π –≥—Ä–∞—Ñ–∏–∫"},{value:"–£–¥–∞–ª–µ–Ω–Ω–∞—è",label:"üè† –£–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞"},{value:"–ß–∞—Å—Ç–∏—á–Ω–∞—è",label:"‚è±Ô∏è –ß–∞—Å—Ç–∏—á–Ω–∞—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å"},{value:"–õ—é–±–æ–π",label:"‚ú® –õ—é–±–æ–π"}]},{id:"desired_salary_from",label:"–ñ–µ–ª–∞–µ–º–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –æ—Ç",type:"number",required:!1,placeholder:"50000",min:0},{id:"desired_salary_to",label:"–ñ–µ–ª–∞–µ–º–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –¥–æ",type:"number",required:!1,placeholder:"100000",min:0}]},"–ü–æ–¥—Ä–∞–±–æ—Ç–∫–∞":{title:"‚è∞ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥—Ä–∞–±–æ—Ç–∫–µ",fields:[{id:"work_type",label:"–¢–∏–ø —Ä–∞–±–æ—Ç—ã",type:"select",required:!0,options:[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø",disabled:!0},{value:"–†–∞–∑–æ–≤–∞—è",label:"üìÖ –†–∞–∑–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞"},{value:"–†–µ–≥—É–ª—è—Ä–Ω–∞—è",label:"üîÑ –†–µ–≥—É–ª—è—Ä–Ω–∞—è –ø–æ–¥—Ä–∞–±–æ—Ç–∫–∞"},{value:"–ü—Ä–æ–µ–∫—Ç–Ω–∞—è",label:"üìã –ü—Ä–æ–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞"},{value:"–í–µ—á–µ—Ä–∞_–≤—ã—Ö–æ–¥–Ω—ã–µ",label:"üåô –í–µ—á–µ—Ä–∞/–≤—ã—Ö–æ–¥–Ω—ã–µ"}]},{id:"work_schedule",label:"–ì—Ä–∞—Ñ–∏–∫",type:"select",required:!1,options:[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä–∞—Ñ–∏–∫",disabled:!0},{value:"–ì–∏–±–∫–∏–π",label:"‚è∞ –ì–∏–±–∫–∏–π –≥—Ä–∞—Ñ–∏–∫"},{value:"–í–µ—á–µ—Ä–∞",label:"üåô –í–µ—á–µ—Ä–Ω–µ–µ –≤—Ä–µ–º—è"},{value:"–í—ã—Ö–æ–¥–Ω—ã–µ",label:"üìÖ –í—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏"},{value:"–£–¥–∞–ª–µ–Ω–Ω–æ",label:"üè† –£–¥–∞–ª–µ–Ω–Ω–æ"}]},{id:"payment_from",label:"–û–ø–ª–∞—Ç–∞ –æ—Ç",type:"number",required:!1,placeholder:"5000",min:0},{id:"payment_to",label:"–û–ø–ª–∞—Ç–∞ –¥–æ",type:"number",required:!1,placeholder:"15000",min:0}]},"–°—Ç–∞–∂–∏—Ä–æ–≤–∫–∞":{title:"üéì –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–µ",fields:[{id:"internship_duration",label:"–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏",type:"select",required:!0,options:[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å",disabled:!0},{value:"1_–º–µ—Å—è—Ü",label:"üìÖ 1 –º–µ—Å—è—Ü"},{value:"2_–º–µ—Å—è—Ü–∞",label:"üìÖ 2 –º–µ—Å—è—Ü–∞"},{value:"3_–º–µ—Å—è—Ü–∞",label:"üìÖ 3 –º–µ—Å—è—Ü–∞"},{value:"6_–º–µ—Å—è—Ü–µ–≤",label:"üìÖ 6 –º–µ—Å—è—Ü–µ–≤"},{value:"–ù–µ_–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ",label:"‚ùì –ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ"}]},{id:"internship_type",label:"–¢–∏–ø —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏",type:"select",required:!0,options:[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø",disabled:!0},{value:"–û–ø–ª–∞—á–∏–≤–∞–µ–º–∞—è",label:"üí∞ –û–ø–ª–∞—á–∏–≤–∞–µ–º–∞—è"},{value:"–ù–µ–æ–ø–ª–∞—á–∏–≤–∞–µ–º–∞—è",label:"üéì –ù–µ–æ–ø–ª–∞—á–∏–≤–∞–µ–º–∞—è"},{value:"–°_–ø–æ—Å–ª–µ–¥—É—é—â–∏–º_—Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º",label:"‚úÖ –° –ø–æ—Å–ª–µ–¥—É—é—â–∏–º —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º"}]},{id:"stipend_amount",label:"–†–∞–∑–º–µ—Ä —Å—Ç–∏–ø–µ–Ω–¥–∏–∏/–æ–ø–ª–∞—Ç—ã",type:"number",required:!1,placeholder:"20000",min:0}]},"–õ–µ–≥–∫–æ–≤—ã–µ":{title:"üöó –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è",fields:[{id:"car_brand",label:"–ú–∞—Ä–∫–∞",type:"text",required:!0,placeholder:"–ù–∞–ø—Ä–∏–º–µ—Ä: Toyota"},{id:"car_model",label:"–ú–æ–¥–µ–ª—å",type:"text",required:!0,placeholder:"–ù–∞–ø—Ä–∏–º–µ—Ä: Camry"},{id:"car_year",label:"–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞",type:"number",required:!0,placeholder:"2020",min:1950,max:(new Date).getFullYear()+1},{id:"car_mileage",label:"–ü—Ä–æ–±–µ–≥ (–∫–º)",type:"number",required:!1,placeholder:"50000",condition:"–°_–ø—Ä–æ–±–µ–≥–æ–º"},{id:"car_engine",label:"–û–±—ä–µ–º –¥–≤–∏–≥–∞—Ç–µ–ª—è (–ª)",type:"text",required:!1,placeholder:"2.0"},{id:"car_transmission",label:"–ö–æ—Ä–æ–±–∫–∞ –ø–µ—Ä–µ–¥–∞—á",type:"select",required:!1,options:[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ –ö–ü–ü",disabled:!0},{value:"–ú–ö–ü–ü",label:"‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è"},{value:"–ê–ö–ü–ü",label:"üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è"},{value:"–†–æ–±–æ—Ç",label:"ü§ñ –†–æ–±–æ—Ç"},{value:"–í–∞—Ä–∏–∞—Ç–æ—Ä",label:"‚ö° –í–∞—Ä–∏–∞—Ç–æ—Ä"}]}]},"–¢–µ–ª–µ—Ñ–æ–Ω—ã":{title:"üì± –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏",fields:[{id:"phone_brand",label:"–ë—Ä–µ–Ω–¥",type:"text",required:!0,placeholder:"Apple, Samsung..."},{id:"phone_model",label:"–ú–æ–¥–µ–ª—å",type:"text",required:!0,placeholder:"iPhone 14 Pro"},{id:"phone_memory",label:"–ü–∞–º—è—Ç—å",type:"select",required:!1,options:[{value:"",label:"–í—ã–±–µ—Ä–∏—Ç–µ",disabled:!0},{value:"64GB",label:"64 –ì–ë"},{value:"128GB",label:"128 –ì–ë"},{value:"256GB",label:"256 –ì–ë"},{value:"512GB",label:"512 –ì–ë"},{value:"1TB",label:"1 –¢–ë"}]}]}};function p(e,t){return!d.has(e)&&(!t||!u.has(t))}const m={async create(){const e=a.getState(),{formData:t,photos:i}=e;let s;p(t.category,t.subcategory)&&(s=t.negotiable?t.price?`${t.price} (—Ç–æ—Ä–≥)`:"–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è":t.price?`${t.price} ‚ÇΩ`:"–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è");const n={category:t.category,subcategory:t.subcategory||void 0,ad_type:"–ü—Ä–æ–¥–∞–º",condition:t.condition||void 0,title:t.title.trim(),description:t.description.trim(),price:s,contact:t.contact.trim(),location:t.location?.address,dynamic_fields:t.dynamicFields,photos:i.map(e=>e.url),scheduled_time:t.scheduledTime||void 0},o=await l.post("/ads",n);return o.success&&o.data?{success:!0,adId:o.data.ad_id}:{success:!1,error:o.error||"Failed to create ad"}},collectFormDataForTelegram(){const e=a.getState(),{formData:t,photos:i}=e;let s=null;p(t.category,t.subcategory)&&(s=t.negotiable?t.price?`${t.price} (—Ç–æ—Ä–≥)`:"–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è":t.price?`${t.price} ‚ÇΩ`:"–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è");const n={category:t.category,subcategory:t.subcategory,condition:t.condition,dynamicFields:t.dynamicFields,title:t.title.trim(),description:t.description.trim(),price:s,contact:t.contact.trim(),location:t.location?.address||null,locationLat:t.location?.lat||null,locationLon:t.location?.lng||null,negotiable:t.negotiable,photos:i.map(e=>e.url),photoCount:i.length,scheduledTime:t.scheduledTime||"now",timestamp:Date.now()};return JSON.stringify(n)}},g={required(e){const t=e.trim().length>0;return{valid:t,message:t?void 0:"–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ"}},minLength(e,t){const i=e.trim().length>=t;return{valid:i,message:i?void 0:`–ú–∏–Ω–∏–º—É–º ${t} —Å–∏–º–≤–æ–ª–æ–≤`}},maxLength(e,t){const i=e.length<=t;return{valid:i,message:i?void 0:`–ú–∞–∫—Å–∏–º—É–º ${t} —Å–∏–º–≤–æ–ª–æ–≤`}},title(e){const t=e.trim();return t.length<n.minTitleLength?{valid:!1,message:`–ú–∏–Ω–∏–º—É–º ${n.minTitleLength} —Å–∏–º–≤–æ–ª–∞`}:t.length>n.maxTitleLength?{valid:!1,message:`–ú–∞–∫—Å–∏–º—É–º ${n.maxTitleLength} —Å–∏–º–≤–æ–ª–æ–≤`}:{valid:!0}},description(e){const t=e.trim();return t.length<n.minDescLength?{valid:!1,message:`–ú–∏–Ω–∏–º—É–º ${n.minDescLength} —Å–∏–º–≤–æ–ª–æ–≤`}:t.length>n.maxDescLength?{valid:!1,message:`–ú–∞–∫—Å–∏–º—É–º ${n.maxDescLength} —Å–∏–º–≤–æ–ª–æ–≤`}:{valid:!0}},contact(e){const t=e.trim();if(!t)return{valid:!1,message:"–í–≤–µ–¥–∏—Ç–µ @username –∏–ª–∏ –Ω–æ–º–µ—Ä"};if(t.startsWith("@")){return/^@[a-zA-Z][a-zA-Z0-9_]{4,31}$/.test(t)?{valid:!0,type:"username",message:"Telegram username ‚úì"}:{valid:!1,type:"username",message:"Username: 5-32 —Å–∏–º–≤–æ–ª–∞ –ø–æ—Å–ª–µ @"}}const i=t.replace(/\D/g,"");return i.length>=10&&i.length<=15?{valid:!0,type:"phone",message:"–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ‚úì"}:i.length>0&&i.length<10?{valid:!1,type:"phone",message:"–ù–æ–º–µ—Ä —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π"}:{valid:!1,message:"–í–≤–µ–¥–∏—Ç–µ @username –∏–ª–∏ –Ω–æ–º–µ—Ä"}},select:e=>({valid:!!e,message:e?void 0:"–í—ã–±–µ—Ä–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ"}),scheduledTime(e,t){if(!e||!t)return{valid:!0};try{return new Date(`${e}T${t}`)<=new Date?{valid:!1,message:"–í—Ä–µ–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –±—É–¥—É—â–µ–º"}:{valid:!0}}catch{return{valid:!1,message:"–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –¥–∞—Ç–∞/–≤—Ä–µ–º—è"}}}};function b(e){return document.getElementById(e)}function v(e,...t){e?.classList.add(...t)}function y(e,...t){e?.classList.remove(...t)}function f(e,t){e&&(e.style.display=t)}function w(e){f(e,"")}function S(e){f(e,"none")}function _(e,t){e&&(e.innerHTML=t)}function C(e,t){e&&(e.textContent=t)}function L(e){return e?.value??""}class T{constructor(){t(this,"container",null),t(this,"currentConfig",null)}init(){this.container=b("dynamicFieldsContainer")}show(e,t){if(this.hide(),this.container||(this.container=b("dynamicFieldsContainer")),!this.container)return;this.currentConfig=t;const i=this.buildHTML(t);this.container.innerHTML=i,this.setupEventListeners(t);const a=b("dynamicFieldsSection");requestAnimationFrame(()=>{a?.classList.add("visible")})}hide(){const e=b("dynamicFieldsSection");e&&(y(e,"visible"),setTimeout(()=>{e.remove(),this.currentConfig=null,a.setCurrentDynamicFields(null),a.clearDynamicFields()},300))}buildHTML(e){let t=`\n      <div class="dynamic-section" id="dynamicFieldsSection">\n        <p class="section-header">${e.title.replace(/^[^\s]+\s/,"")}</p>\n        <div class="form-group-container">\n    `;return e.fields.forEach((i,a)=>{t+=this.buildFieldHTML(i,a===e.fields.length-1)}),t+="</div></div>",t}buildFieldHTML(e,t){const i=`dynamic_${e.id}`,a=!!e.condition;let s=`\n      <div class="form-input-row ${a?"conditional-field":""}"\n           id="${i}Row"\n           ${a?`data-condition="${e.condition}"`:""}\n           style="${a?"display: none;":""}">\n        <span class="input-label">${e.label}</span>\n    `;return"select"===e.type&&e.options?s+=`\n        <select class="input-borderless text-right" id="${i}">\n          ${e.options.map(e=>`<option value="${e.value}" ${e.disabled?"disabled selected":""}>${e.label}</option>`).join("")}\n        </select>\n      `:"textarea"===e.type?s+=`</div><div class="form-textarea-row"><textarea class="textarea-borderless" id="${i}" placeholder="${e.placeholder||""}"></textarea>`:s+=`\n        <input type="${e.type}" \n               class="input-borderless text-right" \n               id="${i}" \n               placeholder="${e.placeholder||""}"\n               ${void 0!==e.min?`min="${e.min}"`:""}\n               ${void 0!==e.max?`max="${e.max}"`:""}>\n      `,s+="</div>",s}setupEventListeners(e){e.fields.forEach(e=>{const t=b(`dynamic_${e.id}`);if(!t)return;const i=()=>this.handleFieldInput(e,t);t.addEventListener("input",i),t.addEventListener("change",i),t.addEventListener("focus",()=>s.haptic("light"))})}handleFieldInput(e,t){a.setDynamicField(e.id,t.value),s.haptic("light")}updateConditionalFields(e){document.querySelectorAll(".conditional-field").forEach(t=>{const i=t,s=i.dataset.condition;if(!s)return;const n=e===s;if(i.style.display=n?"flex":"none",!n){const e=i.querySelector(".input-borderless");if(e){e.value="";const t=e.id.replace("dynamic_","");a.setDynamicField(t,"")}}})}validate(){const e=a.getState(),{formData:t}=e,i=[];return this.currentConfig?(this.currentConfig.fields.forEach(e=>{if(!e.required)return;if(e.condition&&t.condition!==e.condition)return;const a=t.dynamicFields[e.id];a?.trim()||i.push(`‚Ä¢ ${e.label}`)}),{valid:0===i.length,errors:i}):{valid:!0,errors:[]}}getConfig(){return this.currentConfig}}const $=new T;const D=new class{constructor(){t(this,"categoryGrid",null),t(this,"subcategorySection",null),t(this,"subcategoryPills",null),t(this,"conditionSection",null),t(this,"conditionSelector",null),t(this,"priceSection",null),t(this,"dynamicFields"),this.dynamicFields=new T}init(){this.cacheElements(),this.setupEventListeners()}cacheElements(){this.categoryGrid=b("categoryGrid"),this.subcategorySection=b("subcategorySection"),this.subcategoryPills=b("subcategoryPills"),this.conditionSection=b("conditionSection"),this.conditionSelector=b("conditionSelector"),this.priceSection=b("priceSection")}setupEventListeners(){this.categoryGrid?.querySelectorAll(".category-item").forEach(e=>{e.addEventListener("click",e=>{const t=e.currentTarget.dataset.category;t&&this.selectCategory(t)})})}selectCategory(e){this.categoryGrid?.querySelectorAll(".category-item").forEach(e=>{y(e,"selected")});const t=this.categoryGrid?.querySelector(`[data-category="${e}"]`);t&&v(t,"selected"),a.updateFormData({category:e,subcategory:null,condition:null}),a.clearDynamicFields(),s.haptic("light"),this.hideSubcategories(),this.hideConditions(),this.dynamicFields.hide(),r[e]?(this.showSubcategories(e),a.setCurrentSubcategories(r[e])):a.setCurrentSubcategories(null),this.updatePriceVisibility()}showSubcategories(e){const t=r[e];if(!this.subcategoryPills||!this.subcategorySection)return;let i="";t.forEach(e=>{const t=e.label.match(/^(\S+)\s/),a=t?t[1]:"",s=e.label.replace(/^(\S+)\s/,"");i+=`\n        <div class="subcategory-pill" data-value="${e.value}">\n          <span class="subcategory-pill-icon">${a}</span>\n          <span>${s}</span>\n        </div>\n      `}),_(this.subcategoryPills,i),this.subcategoryPills.querySelectorAll(".subcategory-pill").forEach(e=>{e.addEventListener("click",e=>{const t=e.currentTarget.dataset.value;t&&this.selectSubcategory(t)})}),v(this.subcategorySection,"visible")}hideSubcategories(){this.subcategorySection&&y(this.subcategorySection,"visible"),a.setCurrentSubcategories(null)}selectSubcategory(e){this.subcategoryPills?.querySelectorAll(".subcategory-pill").forEach(e=>{y(e,"selected")});const t=this.subcategoryPills?.querySelector(`[data-value="${e}"]`);t&&v(t,"selected"),a.updateFormData({subcategory:e,condition:null}),s.haptic("light"),this.hideConditions(),this.dynamicFields.hide(),c[e]?(this.showConditions(e),a.setCurrentConditions(c[e])):a.setCurrentConditions(null),h[e]?(this.dynamicFields.show(e,h[e]),a.setCurrentDynamicFields(h[e])):a.setCurrentDynamicFields(null),this.updatePriceVisibility()}showConditions(e){const t=c[e];if(!this.conditionSelector||!this.conditionSection)return;let i="";t.forEach(e=>{const t=e.label.match(/^(\S+)\s/),a=t?t[1]:"",s=e.label.replace(/^(\S+)\s/,"");i+=`\n        <div class="condition-chip" data-value="${e.value}">\n          <span>${a}</span>\n          <span>${s}</span>\n        </div>\n      `}),_(this.conditionSelector,i),this.conditionSelector.querySelectorAll(".condition-chip").forEach(e=>{e.addEventListener("click",e=>{const t=e.currentTarget.dataset.value;t&&this.selectCondition(t)})}),v(this.conditionSection,"visible")}hideConditions(){this.conditionSection&&y(this.conditionSection,"visible"),a.setCurrentConditions(null)}selectCondition(e){this.conditionSelector?.querySelectorAll(".condition-chip").forEach(e=>{y(e,"selected")});const t=this.conditionSelector?.querySelector(`[data-value="${e}"]`);t&&v(t,"selected"),a.updateFormData({condition:e}),s.haptic("light"),this.dynamicFields.updateConditionalFields(e)}updatePriceVisibility(){const e=a.getState(),{category:t,subcategory:i}=e.formData;if(!this.priceSection)return;p(t,i)?v(this.priceSection,"visible"):(y(this.priceSection,"visible"),a.updateFormData({price:"",negotiable:!1}))}validate(){const e=a.getState(),{formData:t}=e,i=[];return t.category||i.push("‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏—è"),e.currentSubcategories&&!t.subcategory&&i.push("‚Ä¢ –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è"),e.currentConditions&&!t.condition&&i.push("‚Ä¢ –°–æ—Å—Ç–æ—è–Ω–∏–µ"),{valid:0===i.length,errors:i}}};const F=new class{constructor(){t(this,"elements",{})}init(){this.cacheElements(),this.setupEventListeners(),this.prefillContact(),D.init()}cacheElements(){["title","description","price","contact","negotiable","scheduleToggle","scheduleDate","scheduleTime","scheduleFields","scheduleHint","descCounter","contactRow","contactHint","locationRow","locationValue","priceSection","progressFill","progressText"].forEach(e=>{this.elements[e]=b(e)})}setupEventListeners(){this.elements.title?.addEventListener("input",()=>this.handleTitleInput()),this.elements.description?.addEventListener("input",()=>this.handleDescriptionInput()),this.elements.contact?.addEventListener("input",()=>this.handleContactInput()),this.elements.price?.addEventListener("input",()=>this.updateProgress()),this.elements.negotiable?.addEventListener("change",()=>{s.haptic("light"),this.updateProgress()}),this.elements.scheduleToggle?.addEventListener("change",()=>this.handleScheduleToggle()),this.elements.scheduleDate?.addEventListener("change",()=>this.updateScheduleHint()),this.elements.scheduleTime?.addEventListener("change",()=>this.updateScheduleHint()),this.elements.locationRow?.addEventListener("click",()=>{s.haptic("light")}),document.querySelectorAll(".input-borderless, .textarea-borderless, .price-input").forEach(e=>{e.addEventListener("focus",()=>s.haptic("light"))})}prefillContact(){const e=s.user;var t,i;e?.username&&this.elements.contact&&(t=this.elements.contact,i=`@${e.username}`,t&&(t.value=i),this.handleContactInput())}handleTitleInput(){const e=L(this.elements.title);a.updateFormData({title:e}),this.updateProgress()}handleDescriptionInput(){const e=L(this.elements.description);a.updateFormData({description:e});const t=this.elements.descCounter;if(t){C(t,`${e.length}/${n.maxDescLength}`),y(t,"warning","danger");const i=e.length/n.maxDescLength;i>=.95?v(t,"danger"):i>=.8&&v(t,"warning")}this.updateProgress()}handleContactInput(){const e=L(this.elements.contact);a.updateFormData({contact:e});const t=g.contact(e),i=this.elements.contactHint,s=this.elements.contactRow;y(s,"has-error","has-success"),t.valid?(C(i,t.message||""),v(s,"has-success")):e.trim()?(C(i,t.message||""),v(s,"has-error")):C(i,""),this.updateProgress()}handleScheduleToggle(){const e=this.elements.scheduleToggle,t=this.elements.scheduleFields;t&&(e?.checked?(v(t,"visible"),this.updateScheduleHint()):(y(t,"visible"),a.updateFormData({scheduledTime:null}),C(this.elements.scheduleHint,"–û–±—ä—è–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏"))),s.haptic("light")}updateScheduleHint(){const e=this.elements.scheduleToggle,t=this.elements.scheduleDate,i=this.elements.scheduleTime,s=this.elements.scheduleHint;if(!e?.checked||!s)return;const n=L(t),l=L(i);if(n&&l)try{const e=new Date(`${n}T${l}`),t=new Date;if(e<=t)C(s,"‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –±—É–¥—É—â–µ–µ –≤—Ä–µ–º—è"),a.updateFormData({scheduledTime:null});else{a.updateFormData({scheduledTime:`${n}T${l}:00`});const i=Math.floor((e.getTime()-t.getTime())/36e5),o=Math.floor(i/24);let r;r=o>0?`–ü—É–±–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ ${o} ${1===o?"–¥–µ–Ω—å":o<5?"–¥–Ω—è":"–¥–Ω–µ–π"}`:i>0?`–ü—É–±–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ ${i} ${1===i?"—á–∞—Å":i<5?"—á–∞—Å–∞":"—á–∞—Å–æ–≤"}`:"–ü—É–±–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ –º–µ–Ω–µ–µ —á–∞—Å–∞",C(s,r)}}catch{C(s,"–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è")}else C(s,"–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è")}updateProgress(){const e=a.getState(),{formData:t}=e;let i=0,s=0;s++,t.category&&i++,e.currentSubcategories&&(s++,t.subcategory&&i++),e.currentConditions&&(s++,t.condition&&i++),e.currentDynamicFields&&e.currentDynamicFields.fields.forEach(e=>{e.required&&(e.condition&&t.condition!==e.condition||(s++,t.dynamicFields[e.id]?.trim()&&i++))}),s++,g.title(t.title).valid&&i++,s++,g.description(t.description).valid&&i++,s++,g.contact(t.contact).valid&&i++;const n=s>0?Math.round(i/s*100):0,l=i===s&&s>0,o=this.elements.progressFill,r=this.elements.progressText;return o&&(o.style.width=`${n}%`,o.classList.remove("low","medium","high","complete"),l?o.classList.add("complete"):n>=70?o.classList.add("high"):n>=40?o.classList.add("medium"):o.classList.add("low")),r&&(C(r,`${n}%`),l?v(r,"complete"):y(r,"complete")),this.updateMainButton(l),n}updateMainButton(e){const t=a.getState();"form"===t.currentView&&(t.uploadingCount>0?s.updateMainButton({text:"–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ...",enabled:!1}):e?s.updateMainButton({text:"–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä ‚Üí",enabled:!0,color:s.themeParams.button_color||"#007aff"}):s.updateMainButton({text:"–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É",enabled:!1,color:"#8e8e93"}))}validate(){const e=[],t=D.validate();e.push(...t.errors);const i=$.validate();e.push(...i.errors);const s=a.getState(),{formData:n}=s;g.title(n.title).valid||e.push("‚Ä¢ –ó–∞–≥–æ–ª–æ–≤–æ–∫ (–º–∏–Ω. 3 —Å–∏–º–≤–æ–ª–∞)"),g.description(n.description).valid||e.push("‚Ä¢ –û–ø–∏—Å–∞–Ω–∏–µ (–º–∏–Ω. 10 —Å–∏–º–≤–æ–ª–æ–≤)"),g.contact(n.contact).valid||e.push("‚Ä¢ –ö–æ–Ω—Ç–∞–∫—Ç –¥–ª—è —Å–≤—è–∑–∏");const l=this.elements.scheduleToggle;if(l?.checked){const t=this.elements.scheduleDate,i=this.elements.scheduleTime;g.scheduledTime(L(t),L(i)).valid||e.push("‚Ä¢ –í—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –±—É–¥—É—â–µ–º")}return{valid:0===e.length,errors:e}}syncToStore(){const e=this.elements.price,t=this.elements.negotiable;a.updateFormData({price:L(e),negotiable:t?.checked||!1})}setLocationValue(e){const t=this.elements.locationValue;t&&(C(t,e),v(t,"has-value"))}},E={async upload(e){const t=await this.fileToBase64(e),i=await l.post("/photos/upload",{image:t,filename:e.name});return i.success&&i.data?i.data:{success:!1,error:i.error||"Upload failed"}},async uploadWithRetry(e,t=n.uploadRetryCount){for(let i=0;i<=t;i++){const a=await this.upload(e);if(a.success)return a;i<t&&await this.delay(n.uploadRetryDelay*(i+1))}return{success:!1,error:"Upload failed after retries"}},fileToBase64:e=>new Promise((t,i)=>{const a=new FileReader;a.onload=()=>{const e=a.result,i=e.includes(",")?e.split(",")[1]:e;t(i)},a.onerror=i,a.readAsDataURL(e)}),delay:e=>new Promise(t=>setTimeout(t,e)),validateFile(e){if(!e.type.startsWith("image/"))return{valid:!1,error:"Not an image file"};if(e.size>n.maxFileSize)return{valid:!1,error:`File too large (max ${n.maxFileSize/1024/1024}MB)`};const t=a.getState();return t.photos.length+t.uploadingCount>=n.maxPhotos?{valid:!1,error:`Maximum ${n.maxPhotos} photos allowed`}:{valid:!0}}};const x=new class{constructor(){t(this,"carousel",null),t(this,"addBtn",null),t(this,"input",null),t(this,"countEl",null),t(this,"localUrls",new Set)}init(){this.carousel=b("photoCarousel"),this.addBtn=b("photoAddBtn"),this.input=b("photoInput"),this.countEl=b("photoCount"),this.setupEventListeners()}setupEventListeners(){this.addBtn?.addEventListener("click",()=>{const e=a.getState();e.photos.length+e.uploadingCount<n.maxPhotos&&(this.input?.click(),s.haptic("light"))}),this.input?.addEventListener("change",e=>{const t=e.target.files;t?.length&&(this.handleFiles(t),this.input&&(this.input.value=""))})}async handleFiles(e){for(const t of Array.from(e)){const e=a.getState();if(e.photos.length+e.uploadingCount>=n.maxPhotos){s.haptic("error");break}E.validateFile(t).valid?await this.uploadFile(t):s.haptic("error")}}async uploadFile(e){const t=`temp_${Date.now()}_${Math.random().toString(36).slice(2)}`,i=URL.createObjectURL(e);this.localUrls.add(i),this.addThumbnail(t,i,!0),a.incrementUploading(),this.updateUI(),F.updateProgress();try{const i=await E.uploadWithRetry(e);i.success&&i.url?(a.addPhoto({id:i.url,url:i.url,thumb:i.url}),this.updateThumbnail(t,i.url),s.haptic("success")):(this.removeThumbnail(t),s.haptic("error"))}catch{this.removeThumbnail(t),s.haptic("error")}finally{a.decrementUploading(),URL.revokeObjectURL(i),this.localUrls.delete(i),this.updateUI(),F.updateProgress()}}addThumbnail(e,t,i){if(!this.carousel||!this.addBtn)return;const a=document.createElement("div");a.className="photo-thumb"+(i?" uploading":""),a.dataset.id=e,a.innerHTML=`\n      <img src="${t}" alt="–§–æ—Ç–æ">\n      ${i?'<div class="upload-spinner"></div>':""}\n      ${i?"":`<button type="button" class="photo-remove" data-id="${e}">√ó</button>`}\n    `,this.addBtn.insertAdjacentElement("afterend",a),i||this.attachRemoveHandler(a,e)}updateThumbnail(e,t){const i=this.carousel?.querySelector(`[data-id="${e}"]`);i&&(i.classList.remove("uploading"),i.dataset.id=t,i.innerHTML=`\n      <img src="${t}" alt="–§–æ—Ç–æ">\n      <button type="button" class="photo-remove" data-id="${t}">√ó</button>\n    `,this.attachRemoveHandler(i,t))}removeThumbnail(e){this.carousel?.querySelector(`[data-id="${e}"]`)?.remove()}attachRemoveHandler(e,t){const i=e.querySelector(".photo-remove");i?.addEventListener("click",e=>{e.stopPropagation(),this.removePhoto(t)})}removePhoto(e){a.removePhoto(e),this.removeThumbnail(e),this.updateUI(),F.updateProgress(),s.haptic("light")}updateUI(){const e=a.getState(),t=e.photos.length+e.uploadingCount;this.addBtn&&(t>=n.maxPhotos?v(this.addBtn,"disabled"):y(this.addBtn,"disabled"),t>0?v(this.addBtn,"has-photos"):y(this.addBtn,"has-photos")),this.countEl&&(t>0?(C(this.countEl,`${t} –∏–∑ ${n.maxPhotos} —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π`),v(this.countEl,"has-photos")):(C(this.countEl,`–î–æ ${n.maxPhotos} —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π`),y(this.countEl,"has-photos")))}cleanup(){this.localUrls.forEach(e=>{try{URL.revokeObjectURL(e)}catch{}}),this.localUrls.clear()}};const P=new class{render(){const e=a.getState(),{formData:t,photos:i}=e;let s=t.category?`#${t.category.replace(/\s+/g,"_").replace(/[()]/g,"")}`:"";t.subcategory&&(s+=` #${t.subcategory}`),t.condition&&(s+=` #${t.condition}`),C(b("previewHashtags"),s),C(b("previewTitle"),t.title.trim()),C(b("previewDescription"),t.description.trim());let n="";if(p(t.category,t.subcategory)){let e;e=t.negotiable?t.price?`${t.price} ‚ÇΩ (—Ç–æ—Ä–≥)`:"–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è":t.price?`${t.price} ‚ÇΩ`:"–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è",n+=this.infoItem("üí∞","–¶–µ–Ω–∞:",e)}if(e.currentDynamicFields&&(n+=this.renderDynamicFieldsInfo(e.currentDynamicFields,t)),t.location){let e=t.location.address;e+=` <a href="https://www.google.com/maps?q=${t.location.lat},${t.location.lng}" target="_blank" style="color: #64B5EF;">üó∫Ô∏è</a>`,n+=this.infoItem("üìç","–õ–æ–∫–∞—Ü–∏—è:",e)}if(n+=this.infoItem("üë§","–ö–æ–Ω—Ç–∞–∫—Ç:",t.contact.trim()),t.scheduledTime)try{const e=new Date(t.scheduledTime).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});n+=this.infoItem("‚è∞","–ü—É–±–ª–∏–∫–∞—Ü–∏—è:",e)}catch{}_(b("previewInfo"),n),this.renderPhotos(i)}infoItem(e,t,i){return`\n      <div class="message-info-item">\n        <span class="message-info-icon">${e}</span>\n        <span><span class="message-info-label">${t}</span> ${i}</span>\n      </div>\n    `}renderDynamicFieldsInfo(e,t){let i="";return e.fields.forEach(e=>{if(e.condition&&t.condition!==e.condition)return;const a=t.dynamicFields[e.id];if(!a?.trim())return;if(e.id.includes("salary_from")||e.id.includes("desired_salary_from")||e.id.includes("payment_from")){const s=e.id.replace("_from","_to"),n=t.dynamicFields[s],l=n?`${a} - ${n} ‚ÇΩ`:`–æ—Ç ${a} ‚ÇΩ`,o=e.id.includes("desired_salary")?"–ñ–µ–ª–∞–µ–º–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞":e.id.includes("payment")?"–û–ø–ª–∞—Ç–∞":"–ó–∞—Ä–ø–ª–∞—Ç–∞";return void(i+=this.infoItem("üí∞",`${o}:`,l))}if(e.id.includes("_to")&&(e.id.includes("salary")||e.id.includes("payment")))return;const s=Object.entries({brand:"üè∑Ô∏è",model:"üè∑Ô∏è",year:"üìÖ",mileage:"üõ£Ô∏è",sphere:"üíº",position:"üíº",schedule:"‚è∞",experience:"‚≠ê",type:"üìù",employment:"üìù",duration:"‚è±Ô∏è"}).find(([t])=>e.id.toLowerCase().includes(t))?.[1]||"üìã";i+=this.infoItem(s,`${e.label}:`,a)}),i}renderPhotos(e){const t=b("previewPhotos");if(!t)return;if(0===e.length)return void S(t);const i=e.length;if(1===i)t.className="message-photos single-photo",_(t,`<div class="message-photo"><img src="${e[0].thumb}" alt="–§–æ—Ç–æ" loading="lazy"></div>`);else{t.className=`message-photos multiple-photos count-${i}`;_(t,e.map(e=>`<div class="message-photo"><img src="${e.thumb}" alt="–§–æ—Ç–æ" loading="lazy"></div>`).join(""))}var a,s;w(t),s={display:"grid"},(a=t)&&Object.assign(a.style,s)}};const B=new class{constructor(){t(this,"map",null),t(this,"selectedLocation",null)}init(){this.loadYandexMaps(),this.setupEventListeners()}loadYandexMaps(){const e=document.getElementById("yandex-maps");e&&!e.src&&(e.src=`https://api-maps.yandex.ru/2.1/?apikey=${n.yandexMapsKey}&lang=ru_RU`)}setupEventListeners(){b("mapCloseBtn")?.addEventListener("click",()=>this.close()),b("mapCancelBtn")?.addEventListener("click",()=>this.close()),b("mapConfirmBtn")?.addEventListener("click",()=>this.confirm()),b("mapMyLocationBtn")?.addEventListener("click",()=>{s.haptic("light"),this.getUserLocation()})}open(){const e=b("mapModal");e&&(v(e,"active"),document.body.style.overflow="hidden",setTimeout(()=>this.initMap(),100),s.haptic("light"))}close(){const e=b("mapModal");e&&(y(e,"active"),document.body.style.overflow="",document.getElementById("centerMarker")?.remove(),this.map&&(this.map.destroy(),this.map=null),s.haptic("light"))}initMap(){this.map||"undefined"==typeof ymaps?"undefined"==typeof ymaps&&setTimeout(()=>this.initMap(),500):ymaps.ready(()=>{this.map=new ymaps.Map("locationMap",{center:n.defaultMapCenter,zoom:13,controls:[]});const e=document.createElement("div");let t;e.id="centerMarker",e.style.cssText="\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -100%);\n        z-index: 1000;\n        pointer-events: none;\n        font-size: 40px;\n        filter: drop-shadow(0 2px 6px rgba(0,0,0,0.4));\n      ",e.innerHTML="üìç",this.map.container.getParentElement().appendChild(e),this.map.events.add("boundschange",()=>{clearTimeout(t),t=setTimeout(()=>{const e=this.map.getCenter();this.updateAddress(e[0],e[1])},500)}),this.getUserLocation()})}getUserLocation(){if(!navigator.geolocation)return void this.updateAddress(n.defaultMapCenter[0],n.defaultMapCenter[1]);const e=b("mapAddress");e&&_(e,'<span class="map-address-loading">‚è≥ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è...</span>'),navigator.geolocation.getCurrentPosition(e=>{this.map&&(this.map.setCenter([e.coords.latitude,e.coords.longitude],15,{duration:300}),this.updateAddress(e.coords.latitude,e.coords.longitude)),s.haptic("success")},()=>{this.updateAddress(n.defaultMapCenter[0],n.defaultMapCenter[1])},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}async updateAddress(e,t){const i=b("mapAddress"),a=b("mapConfirmBtn");i&&_(i,'<span class="map-address-loading">üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞...</span>'),a&&(a.disabled=!0);try{const i=(await new Promise((i,a)=>{ymaps.geocode([e,t],{results:1}).then(i).catch(a)})).geoObjects.get(0);if(!i)throw new Error("Address not found");let a=i.getAddressLine().replace(/^–†–µ—Å–ø—É–±–ª–∏–∫–∞\s+[^,]+,\s*/i,"").replace(/^[–ê-–Ø–∞-—è\s]+–æ–±–ª–∞—Å—Ç—å,\s*/i,"").replace(/^[–ê-–Ø–∞-—è\s]+–∫—Ä–∞–π,\s*/i,"");this.selectedLocation={address:a||`${e.toFixed(4)}, ${t.toFixed(4)}`,lat:e,lng:t}}catch{this.selectedLocation={address:`${e.toFixed(4)}, ${t.toFixed(4)}`,lat:e,lng:t}}i&&_(i,`üìç ${this.selectedLocation.address}`),a&&(a.disabled=!1)}confirm(){this.selectedLocation&&(a.setLocation(this.selectedLocation),F.setLocationValue(this.selectedLocation.address),this.close(),s.haptic("success"))}};const M=new class{constructor(){t(this,"header",null),t(this,"slotsIndicator",null),t(this,"slotsCount",null),t(this,"cooldownWarning",null),t(this,"cooldownTime",null)}init(){this.header=b("header"),this.slotsIndicator=b("slotsIndicator"),this.slotsCount=b("slotsCount"),this.cooldownWarning=b("cooldownWarning"),this.cooldownTime=b("cooldownTime"),this.setupScrollListener(),this.update(),a.subscribe(()=>this.update())}setupScrollListener(){const e=function(e,t){let i=!1;return(...a)=>{i||(e(...a),i=!0,setTimeout(()=>i=!1,t))}}(()=>{this.header},50);window.addEventListener("scroll",e,{passive:!0})}update(){const e=a.getState().userLimits;if(this.slotsIndicator&&this.slotsCount&&e){const t=e.availableSlots;C(this.slotsCount,`${t}/${e.maxSlots}`),y(this.slotsIndicator,"warning","full"),0===t?v(this.slotsIndicator,"full"):t<=2&&v(this.slotsIndicator,"warning")}if(this.cooldownWarning&&this.cooldownTime&&e)if(e.cooldownSeconds&&e.cooldownSeconds>0){const t=Math.floor(e.cooldownSeconds/3600),i=Math.floor(e.cooldownSeconds%3600/60);C(this.cooldownTime,t>0?`${t} —á ${i} –º–∏–Ω`:`${i} –º–∏–Ω`),v(this.cooldownWarning,"visible")}else y(this.cooldownWarning,"visible")}setTitle(e,t){C(b("headerTitle"),e),C(b("headerSubtitle"),t)}};const k=new class{constructor(){t(this,"formView",null),t(this,"previewView",null),t(this,"tabBar",null)}async init(){s.init(),this.formView=b("formView"),this.previewView=b("previewView"),this.tabBar=b("tabBar"),M.init(),F.init(),x.init(),B.init(),this.setupNavigation(),this.setupTabBar(),this.initScheduleDate(),await this.authenticate(),this.setupMainButton(),this.setupClosingConfirmation()}async authenticate(){try{await o.authenticate()?(await o.getUserLimits(),M.update()):(a.setUserLimits({activeSlots:0,maxSlots:5,availableSlots:5,cooldownSeconds:null,canPublish:!0,isAdmin:!1}),M.update())}catch(e){}}setupMainButton(){s.setupMainButton("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É",()=>{this.handleMainButtonClick()}),s.updateMainButton({enabled:!1,visible:!0,color:"#8e8e93"})}handleMainButtonClick(){"form"===a.getState().currentView?this.showPreview():this.submitAd()}setupNavigation(){b("backToFormBtn")?.addEventListener("click",()=>{this.showForm()}),b("locationRow")?.addEventListener("click",()=>{B.open()})}setupTabBar(){b("tabSearch")?.addEventListener("click",()=>{s.haptic("light")}),b("tabCreate")?.addEventListener("click",()=>{s.haptic("medium")}),b("tabProfile")?.addEventListener("click",()=>{s.haptic("light")})}initScheduleDate(){const e=b("scheduleDate");if(!e)return;const t=new Date,i=new Date(t);i.setDate(i.getDate()+1),e.min=t.toISOString().split("T")[0],e.value=i.toISOString().split("T")[0]}showForm(){a.setCurrentView("form"),v(this.previewView,"slide-out-right"),setTimeout(()=>{S(this.previewView),y(this.previewView,"slide-out-right"),w(this.formView),v(this.formView,"active","slide-in-left"),w(this.tabBar),setTimeout(()=>{y(this.formView,"slide-in-left")},300)},300),M.setTitle("–°–æ–∑–¥–∞—Ç—å","–ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ"),s.setupMainButton("–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä ‚Üí",()=>this.showPreview()),F.updateProgress(),s.haptic("light")}showPreview(){F.syncToStore();const{valid:e,errors:t}=F.validate();if(!e)return s.haptic("error"),void s.showPopup("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ","–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:\n\n"+t.join("\n"));a.setCurrentView("preview"),P.render(),v(this.formView,"slide-out-left"),setTimeout(()=>{S(this.formView),y(this.formView,"slide-out-left","active"),S(this.tabBar),w(this.previewView),v(this.previewView,"active","slide-in-right"),setTimeout(()=>{y(this.previewView,"slide-in-right")},300)},300),M.setTitle("–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä","–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ"),s.setupMainButton("‚úì –û—Ç–ø—Ä–∞–≤–∏—Ç—å",()=>this.submitAd()),s.updateMainButton({enabled:!0,color:s.themeParams.button_color||"#007aff"}),s.haptic("success")}async submitAd(){s.haptic("medium"),s.updateMainButton({progress:!0,enabled:!1});try{if(a.getState().isAuthenticated){if((await m.create()).success)return s.haptic("success"),void s.showAlert("‚úÖ –û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é!",()=>{s.tg?.close()})}const e=m.collectFormDataForTelegram();if(e.length>n.maxDataSize)throw new Error("–î–∞–Ω–Ω—ã–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ. –°–æ–∫—Ä–∞—Ç–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ.");s.sendData(e)?s.haptic("success"):alert(`–†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏\n\n–î–∞–Ω–Ω—ã–µ –≥–æ—Ç–æ–≤—ã: ${e.length} bytes`)}catch(e){s.haptic("error"),s.showPopup("–û—à–∏–±–∫–∞",e.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ")}finally{s.updateMainButton({progress:!1,enabled:!0})}}setupClosingConfirmation(){a.subscribe(e=>{e.formData.category||e.formData.title.trim()||e.formData.description.trim()||e.formData.contact.trim()||e.photos.length>0?s.enableClosingConfirmation():s.disableClosingConfirmation()})}destroy(){x.cleanup()}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>k.init()):k.init(),window.addEventListener("beforeunload",()=>{k.destroy()});
